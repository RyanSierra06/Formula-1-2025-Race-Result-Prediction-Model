# Formula-1-2025-Race-Prediction
Used Scikit learn's Random Forest Regressor model as well as the OpenF1 api to gather historical race data and predict the outcome of races during the 2025 Formula 1 season.

I wrote 5 differnt python files, 3 of which were used to gather, transform, and featurize data, with the other 2 being used to build the model and test and train it based on the specific race the user wanted to use the algorithm on.

The model works by taking in all the race data from the 2023 and 2024 seasons, as well as the data from the races up to the one were predcting the race outcome for in the 2025 season. So for example, if were trying to predict the outcome for the Japanese Grand Prix, we train the model on all the 2023 and 2024 data, as well as the first 3 races of the 2025 season (Bahrain, Australia, and China).

Below is a short description of each file and the purpose it accomplishes:
- get_race_data.py:
  - The get_race_data file uses the OpenF1 api to get the session keys for a given race (based on country name, location, and year), a list of all the races in a particular year, as well as a list of all the drivers for a given race weekend (using the session key defined earlier). get_race_data also has functions that are used to get raw lap data, as well as transform that data to get the best and average lap times for each session (free practices, sprints, qualifying) as well as the splits for that session (ie. sector 1, sector 2, etc.). All of these functions are used within places like build_dataframe as well as some other special cases within build_all_csv_files.
- build_dataframe.py:
  - The build_dataframe file uses the get_race_data file and its functions to concatinate data together into a single dataframe for a specific race. It builds a dataframe that houses the specific info like lap times, sector splits, qualifying averages, final race position, etc. for each driver that races in any single session during the weekend. This dataframe is then expoted to a csv file when the function build_grandprix_results_dataframe() is called, allowing for local storage of data, making model training and testing a lot quicker and more efficient.
- build_all_csv_files.py:
  - The build_all_csv_files file uses the build_grandprix_results_dataframe() function from build_dataframe.py to build all the csv files from every race that happened during 2023, 2024, and all of the current race in 2025 (as of writing this the local data only has historical data up to the 2025 Spainish Grandprix). It stores all of this data within the Formula_1_Grandprix_Data folder and then within specific subfolders pertaining to the year the race was held. Storing all of these races within csv files allows for this data to be called upon a lot quicker than if we were to remake the dataframes every time we call the model to train on the same data over and over again.
- build_model.py:
  - The build_model file has 3 functions: featurize_data, load_grandprix_df, and build_model. featurize_data() loads in a given dataframe from the stored csv files (using load_grandprix_df()) and adds more information such as "Qualifying position minus practice 3 position", "Sprint best lap minus qualifying best lap", as well other deltas, splits, and driver vs team data to give the model more information on how each driver is fairing throughout the race weekend to make race prediction more accurate. The build_model function takes in the race that the user wants to predict the outcome for, and finds all the races before that, and puts all those races into the training data to train the random forest regressor model on. Then after passing in all the data of all the races previous, we take the race that the user wants to predict the race outcome for, and use the model we just trained to predict the outcome of how it thinks all the drivers this race will fair based on their practice, qualifying, and potentially sprint times as well. 
- main.py:
  -  The main file is whats used to actually run the model and test everything. It shows the user all the races of the 2025 year so far (at the time of writing it only shows up to the Spanish Grandprix), and from there the user inputs the country (ie. Japan) and the location (ie. Suzuka) and the model is then trained on all the races up to that point, and then predicts the race result for the race the user is asking about (ie. Suzuka, Japan).


Limitations of the model:
- When looking at limitations of the model there were a few things I noticed. for one, the model cant predict random events like a driver crashing out in a race, poor strategy calls from the pit wall, safety car deployments, or engine failures, all of which can drastically alter the outcome of a single drivers race performance. With that being said though, the model is able to predict, on average, within 3 places of where the driver will end up for the race. Furthermore, driver changes to different teams at the beginning of the season and even mid season makes it hard for the model to adapt and predict where that driver might end up. Carlos Sainz for example went from Ferarri, the 2nd best team at the end of the 2024 season, to Williams, the 9th best team at the end of the 2024 season. Without that being spefically engineered into the model, its hard for it to take in the fact that Sainz is now in a slower car. It's also hard to determine the overall ranking of each constructor as, on a track to track basis, a lot of the midfield teams tend to alternate and become better or worse for a given weekend as some cars are better suited for certain conditions.

To Try the model for yourself, simply run the build_all_csv_files.py file to make sure all your data is up to date, and then run main.py to test the model on any 2025 race you want to predict the outcome for!

Attached below is a example of the model being used to predict the result of the 2025 Japanese Grandprix:
<img width="843" alt="Screenshot 2025-06-12 at 12 35 33 AM" src="https://github.com/user-attachments/assets/f77710f2-6f94-4dc3-9aef-89cadd033de0" />
<img width="695" alt="Screenshot 2025-06-12 at 12 35 59 AM" src="https://github.com/user-attachments/assets/e98b7097-1476-4662-b51a-c76c7401fe73" />

